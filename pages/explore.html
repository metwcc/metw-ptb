<script init>
    p.data = await session.explore()
    p.users = await session.getUsers(p.data.users)
    await session.getUsers(p.data.posts.map(i => i.user_id))
    p.posts = []
    for (i of p.data.posts)
        p.posts.push(new metw.Post({ ...i, user: await session.getUser(i.user_id), session: session }))
    resolve()
</script>

<body>
    <ul class="users-list"></ul>
    <ul class="posts-list"></ul><br />
</body>

<style>
    .p .users-list { display: flex; flex-wrap: wrap; padding: 0; margin: 0 }
    .p .users-list li { padding: 0; list-style: none; flex-basis: calc(33.33% - 20px); height: 54px; display: grid; align-items: center; margin: 8px; border-radius: 10px; cursor: pointer; overflow: hidden }
    .p .users-list li > * { grid-row: 1; grid-column: 1 }
    .p .users-list li .banner { background: no-repeat center center; width: 100%; height: 100%; background-size: cover; opacity: 0.2 }
    .p .users-list li div:last-of-type { display: flex; align-items: center }
    .p .users-list li img { height: 32px; margin: 8px; border-radius: 50% }
    .p .users-list li span { font-size: 20px }

    @media (max-width: 1100px) {
        .p .users-list li { flex-basis: calc(50% - 20px) }
    }
    @media (max-width: 700px) {
        .p .users-list li { flex-basis: calc(100% - 20px) }
    }
</style>

<script>
    Object.assign(p, {
        userList: p.querySelector('.users-list'),
        postsList: p.querySelector('.posts-list')
    })

    for (let user of p.users) {
        let li = d.createElement('li')
        li.className = "bg-1 bd"
        li.onclick = () => redirect(`/@${user.username}`)
        li.innerHTML = `
            <div class="banner" style="background-image: url('${user.profile.bannerURL}')"></div>
            <div>
                <img src="${user.profile.avatarURL}" />
                <span>${user.fullUsername}</span>
            </div   >`
        p.userList.appendChild(li)
    }

    for (post of p.posts) p.postsList.appendChild(metw.gui.post(post))
</script>